---
layout: default
title: Update Spreadsheet
---

<!--These are JavaScript Libraries-->
<!-- <script type="text/javascript" src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script> -->

<script type="text/javascript" src="papaparse.min.js"></script> <!-- https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js -->
<script type="text/javascript" src="js-yaml.min.js"></script> <!-- https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js -->
<script type="text/javascript" src="github.js"></script>

<h1>Update</h1>
<select id="positionFilter">
    <option value="all">All Positions</option>
    <option value="PhD student">PhD student</option>
    <option value="Intern">Intern</option>
    <option value="Undergraduate student">Undergraduate student</option>
    <option value="Research Assistant">Research Assistant</option>
    <option value="MS(R) student">MS(R) student</option>
    <option value="MSc student">MSc student</option>
</select>

<script type="text/javascript">

    // URL for the TSV file
    var tsvURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSmbxH5Ht8VVSH7d255fpfmuQ4txgw8nTzxsIJsXgJAdLe6jd_r-zomkND043i-pq0tWiZai-63NcOv/pub?output=tsv';

    // Add event listener to the position filter dropdown
    document.getElementById('positionFilter').addEventListener('change', function() {
        filterData(this.value);
    });

    window.addEventListener('DOMContentLoaded', function() {
        filterData('all');
    });

    function filterData(selectedPosition) {
        Papa.parse(tsvURL, {
            download: true,
            header: true,
            delimiter: "\t",
            complete: function(results) {
                var data = results.data;
                var filteredData = data.filter(function(row) {
                    return selectedPosition === 'all' || row.Position === selectedPosition;
                });
                showFilteredInfo(filteredData);
            }
        });
    }

    function showFilteredInfo(filteredData) {
        var $items = [];
        filteredData.forEach(function(row) {
            var $p = {};
            Object.keys(row).forEach(function(key) {
                $p[key.toLowerCase()] = row[key];
            });
            $items.push($p);
        });
        var $yaml_dump = jsyaml.dump($items);
        document.getElementById('source').value = $yaml_dump;
    }

</script>

<textarea cols="10" rows="5" id="source" style="border: 1px solid #000; width: 100%; height: 500px;"></textarea>
